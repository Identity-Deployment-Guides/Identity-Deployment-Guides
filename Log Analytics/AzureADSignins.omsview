{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "location": {
            "type": "string",
            "defaultValue": ""
        },
        "resourcegroup": {
            "type": "string",
            "defaultValue": ""
        },
        "subscriptionId": {
            "type": "string",
            "defaultValue": ""
        },
        "workspace": {
            "type": "string",
            "defaultValue": ""
        },
        "workspaceapiversion": {
            "type": "string",
            "defaultValue": ""
        }
    },
    "resources": [
        {
            "apiVersion": "[parameters('workspaceapiversion')]",
            "name": "[parameters('workspace')]",
            "type": "Microsoft.OperationalInsights/workspaces",
            "location": "[parameters('location')]",
            "id": "[Concat('/subscriptions/', parameters('subscriptionId'), '/resourceGroups/', parameters('resourcegroup'), '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'))]",
            "resources": [
                {
                    "apiVersion": "2015-11-01-preview",
                    "name": "Sign-ins Events",
                    "type": "views",
                    "location": "[parameters('location')]",
                    "id": "[Concat('/subscriptions/', parameters('subscriptionId'), '/resourceGroups/', parameters('resourcegroup'), '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'),'/views/Sign-ins Events')]",
                    "dependson": [
                        "[Concat('/subscriptions/', parameters('subscriptionId'), '/resourceGroups/', parameters('resourcegroup'), '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'))]"
                    ],
                    "properties": {
                        "Id": "Sign-ins Events",
                        "Name": "Sign-ins Events",
                        "Author": null,
                        "Source": "Local",
                        "Version": 2,
                        "Dashboard": [
                            {
                                "Id": "LineChartCalloutBuilderBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "Sign-ins by App",
                                        "newGroup": true,
                                        "icon": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAUpSURBVGhDxZpNdhNHFIVflWzDEFYQZQWIYQw54EFCMgKvINEKjFhAhMjcklaAvQIzS3IyEJyAM7RYQcwOPLWhu3JvdUlI7qrq6rZkf+fY6m7L6r5V76/qSclV2ZvcEdnoiNaPRdQ3IqYtSuGatIs3mDMxaoqDMxx/EmVOZf/hQfG31dFMCB++tfkMD/gLHrqDK3zwehh5g18fJdcHMv7u1F1tTD0hVsBWH//2K87qP3wIispV7yqC0oSsS0AJM5JMj5sIqhay989jaenXeKuz+WvASE+G2yN3lkRcSO/4Od6BmVjnLASguQ23d91ZJX4hX03pubtyU0wlU7sppqbd6zL6Fk3ppkWQjrTMiey9Z2SMUp6RF+/h0PSJRkxhEqc2VxiFnJEzh8C35vkFuaYJ+Lzs4r6Md5CL/JSF9I6PcPWZO6vGmLf4/U5y80bGD5n44nCgjH5a6x4FU9nfvu+OS3hm5PgEvyun0gpQMpb9B0hsDaC5aN2vN2jhAODxETvCMWAuCI/5xW5jEYSzZx8q77or1VB0wF/KQpiQwrBe6toYH7HXWrDuynKYDPwghZY6ckdLBMIvk2Br4s4KaEq57vpCYf8PaRst3gCBGxwOnkh1kViEfJh1QuL1JEy/kBkvPrAwbEuewYm/TGOzADEQL8viZxjppon5t41w+587i3EGx7/rji1xITXp/wkb1uKd+mQxHDzxm88y8K2F5YA/ITZk8BOrWEy7DyWv+38Ji844DCAmQbDoPXdgWakQAjGj3MjAnS6TKiY/9w/GMh1rio6VCyG/P5GXRgKjSjE0wRj0xZRZaWXzSmEtQsirH6UbFAM/ssEhRq78s7qI0Y/c0fqEkKgYRLioGBvmK3LLQlWwViHEijHirxaqxAjX9WnY8Pvb3zKETdYt4mqBG4UTXSY7g589YlNCcXZ+lz6lEEU6uAsLxZvFJyZJSLYj4+/fasT961/G+qCZcVAXyS6qCtg5a/eRVIySETL/pfXM7eRB1nJbpnDG1VSyDaGIVz/4KoIsQYiyzz6vtZIybkPwoI9wI+/nU4TakMFgxzOYKcvuTH3LUL3SotEHwytK/COlyr4YFUGK7aihO/Ozv201rNVH6LxBEUiUUREF99xriLlPrU2IFSEyCYrYlF5UBBdaVet5s2YhURHI8pUiiL5Fn6py9o/udfVCrAgVMCeK2JLdShEW89QdhMnVvIRZqRA4dtuK8JQjmKFpsghm9KrNPG4NLewfrEyIFYHsHBSxiRIkRQR9QxQ3ziswc7Mi4fBrP3CjIy3VlgzlNOoZ95cS/YncMZ+tiNKeUy0RJGmns7yF6hfi74lEd8Ypxh2WqCGiOm8QYwYyfPDSnVnKQootGVbDvgc7Q7UJMeHZaUStNoZ/Q7vsI9rEGju4YWtiR25VUES9NkbPt79WFqJMPFoQTj9teWEXoxHWhLdOqn1ihhmF9pvLptX7MKnVx7Ad2WycbG52BrbgC4p5onrX/yvw0XMsovy7nR4hiQ5Xhk0elAzmk+Q5RG24oPAFPoegYTTN9Z4b/WBg8EO/0BARbsH5o1Zqj+R6QIDJISLeRPInRHaGaDI3T5IIEs7sbMIwXt8UbGNkCmE2oZ0H/Ka1iK9Xsnb4DYiLQcixfVQLmdE8CKRjm0kGeSJtFhZJF0KK5DXEf612fW8bq+bwKl9/qidkRiEIYrBmaNw7Z/1lDlCQHjaZgcs0E3IZ26JjuJ59MYCl/Lzg5APjR7FVwDzwrsgzn1FRp/tAHJH/AbghFlliYr94AAAAAElFTkSuQmCC",
                                        "useIcon": true
                                    },
                                    "Header": {
                                        "Title": "Sign-ins overtime",
                                        "Subtitle": ""
                                    },
                                    "LineChart": {
                                        "Query": "SigninLogs |summarize signInCount = count() by bin(TimeGenerated, 24h) ",
                                        "Callout": {
                                            "Title": "Total Sign-ins",
                                            "Series": "",
                                            "Operation": "Sum"
                                        },
                                        "yAxis": {
                                            "isLogarithmic": false,
                                            "units": {
                                                "baseUnitType": "",
                                                "baseUnit": "",
                                                "displayUnit": ""
                                            },
                                            "customLabel": ""
                                        },
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "SigninLogs|summarize signInCount = count() by AppDisplayName|sort by signInCount desc ",
                                        "HideGraph": false,
                                        "enableSparklines": false,
                                        "operation": "Count",
                                        "ColumnsTitle": {
                                            "Name": "Application Name",
                                            "Value": "# of Sign-ins"
                                        },
                                        "Color": "#dd5900",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": "SigninLogs |extend errorCode = toint(Status.errorCode) |extend SigninStatus = case(errorCode == 0, \"Success\",                        errorCode == 50058, \"Interrupt\",  errorCode == 50140, \"Interrupt\",  errorCode == 51006, \"Interrupt\",  errorCode == 50059, \"Interrupt\",  errorCode == 65001, \"Interrupt\",  errorCode == 52004, \"Interrupt\",  errorCode == 50055, \"Interrupt\",  errorCode == 50144, \"Interrupt\",  errorCode == 50072, \"Interrupt\",  errorCode == 50074, \"Interrupt\",  errorCode == 16000, \"Interrupt\",  errorCode == 16001, \"Interrupt\",  errorCode == 16003, \"Interrupt\",  errorCode == 50127, \"Interrupt\",  errorCode == 50125, \"Interrupt\",  errorCode == 50129, \"Interrupt\",  errorCode == 50143, \"Interrupt\",  errorCode == 81010, \"Interrupt\",  errorCode == 81014, \"Interrupt\",  errorCode == 81012 ,\"Interrupt\",  \"Failure\") |extend StatusReason =tostring(Status.failureReason) |extend Country = tostring(LocationDetails.countryOrRegion) |extend State = tostring(LocationDetails.state) |extend City = tostring(LocationDetails.city) |where AppDisplayName !=\"\" |where {selected item} |summarize signInCount = count() by CreatedDateTime, AppDisplayName, UserDisplayName, UserPrincipalName, ClientAppUsed,SigninStatus,StatusReason, ConditionalAccessStatus, IPAddress, City, State, Country |sort by signInCount,AppDisplayName desc",
                                        "NavigationSelect": {
                                            "NavigationQuery": "SigninLogs |extend errorCode = toint(Status.errorCode) |extend SigninStatus = case(errorCode == 0, \"Success\",                        errorCode == 50058, \"Interrupt\",  errorCode == 50140, \"Interrupt\",  errorCode == 51006, \"Interrupt\",  errorCode == 50059, \"Interrupt\",  errorCode == 65001, \"Interrupt\",  errorCode == 52004, \"Interrupt\",  errorCode == 50055, \"Interrupt\",  errorCode == 50144, \"Interrupt\",  errorCode == 50072, \"Interrupt\",  errorCode == 50074, \"Interrupt\",  errorCode == 16000, \"Interrupt\",  errorCode == 16001, \"Interrupt\",  errorCode == 16003, \"Interrupt\",  errorCode == 50127, \"Interrupt\",  errorCode == 50125, \"Interrupt\",  errorCode == 50129, \"Interrupt\",  errorCode == 50143, \"Interrupt\",  errorCode == 81010, \"Interrupt\",  errorCode == 81014, \"Interrupt\",  errorCode == 81012 ,\"Interrupt\",  \"Failure\") |extend StatusReason =tostring(Status.failureReason) |extend Country = tostring(LocationDetails.countryOrRegion) |extend State = tostring(LocationDetails.state) |extend City = tostring(LocationDetails.city) |where AppDisplayName !=\"\" |where {selected item} |summarize signInCount = count() by CreatedDateTime, AppDisplayName, UserDisplayName, UserPrincipalName, ClientAppUsed,SigninStatus,StatusReason, ConditionalAccessStatus, IPAddress, City, State, Country |sort by signInCount,AppDisplayName desc"
                                        }
                                    }
                                }
                            },
                            {
                                "Id": "SingleQueryDonutBuilderBladeV1",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "Sign-ins by Device",
                                        "newGroup": false,
                                        "icon": "",
                                        "useIcon": false
                                    },
                                    "Header": {
                                        "Title": "Device Sign-ins",
                                        "Subtitle": ""
                                    },
                                    "Donut": {
                                        "Query": "SigninLogs |extend OS= DeviceDetail.operatingSystem  |extend Browser =extract(\"([a-zA-Z]+)\",1,tostring(DeviceDetail.browser))  | where OS!=\"\" | where Browser !=\"\" | where AppDisplayName !=\"\"  |summarize count() by tostring(OS)",
                                        "CenterLegend": {
                                            "Text": "Sign-ins",
                                            "Operation": "Sum",
                                            "ArcsToSelect": []
                                        },
                                        "Options": {
                                            "colors": [
                                                "#00188f",
                                                "#0072c6",
                                                "#00bcf2"
                                            ],
                                            "valueColorMapping": []
                                        },
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "SigninLogs |extend OS= DeviceDetail.operatingSystem  |extend Browser =extract(\"([a-zA-Z]+)\",1,tostring(DeviceDetail.browser))  | where OS!=\"\" | where Browser !=\"\" | where AppDisplayName !=\"\"   |summarize count() by tostring(OS), Browser |sort by count_ desc",
                                        "HideGraph": false,
                                        "enableSparklines": false,
                                        "operation": "Summary",
                                        "ColumnsTitle": {
                                            "Name": "OS",
                                            "Value": "Sign-ins"
                                        },
                                        "Color": "#0072c6",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": "SigninLogs  |extend OS= DeviceDetail.operatingSystem  |extend Browser =extract(\"([a-zA-Z]+)\",1,tostring(DeviceDetail.browser)) |where OS!=\"\" |where Browser !=\"\" |where AppDisplayName !=\"\" |where {selected item}|summarize Users = dcount(UserId) by CreatedDateTime, AppDisplayName,tostring(OS),Browser,UserDisplayName, UserPrincipalName, ClientAppUsed, IPAddress |sort by Users desc ",
                                        "NavigationSelect": {
                                            "NavigationQuery": "SigninLogs  |extend OS= DeviceDetail.operatingSystem  |extend Browser =extract(\"([a-zA-Z]+)\",1,tostring(DeviceDetail.browser)) |where OS!=\"\" |where Browser !=\"\" |where AppDisplayName !=\"\" |where {selected item}|summarize Users = dcount(UserId) by CreatedDateTime, AppDisplayName,tostring(OS),Browser,UserDisplayName, UserPrincipalName, ClientAppUsed, IPAddress |sort by Users desc "
                                        }
                                    }
                                }
                            },
                            {
                                "Id": "SingleQueryDonutBuilderBladeV1",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "APP SIGN-IN By LOCATION",
                                        "newGroup": false,
                                        "icon": "",
                                        "useIcon": false
                                    },
                                    "Header": {
                                        "Title": "--",
                                        "Subtitle": "APP Sign-in By Location"
                                    },
                                    "Donut": {
                                        "Query": "SigninLogs | where AppDisplayName !=\"\" |summarize signInCount = count() by Location",
                                        "CenterLegend": {
                                            "Text": "Total",
                                            "Operation": "Sum",
                                            "ArcsToSelect": []
                                        },
                                        "Options": {
                                            "colors": [
                                                "#00188f",
                                                "#0072c6",
                                                "#00bcf2"
                                            ],
                                            "valueColorMapping": []
                                        },
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "SigninLogs | where AppDisplayName !=\"\"  |summarize signInCount = count() by Location, AppDisplayName",
                                        "HideGraph": false,
                                        "enableSparklines": true,
                                        "operation": "Summary",
                                        "ColumnsTitle": {
                                            "Name": "LOCATION",
                                            "Value": "Count"
                                        },
                                        "Color": "#0072c6",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": "SigninLogs | where AppDisplayName !=\"\"   | mvexpand Status |extend StatusReason = Status.FailureReason | extend SigninStatus = Status.ErrorCode |extend Country = tostring(LocationDetails.countryOrRegion) |extend State = tostring(LocationDetails.state) |extend City = tostring(LocationDetails.city) | where {selected item}   |summarize signInCount = count() by CreatedDateTime, AppDisplayName, UserDisplayName, UserPrincipalName, ClientAppUsed,tostring(SigninStatus),tostring(StatusReason), ConditionalAccessStatus, IPAddress, City, State, Country |sort by signInCount,AppDisplayName desc",
                                        "NavigationSelect": {
                                            "NavigationQuery": "SigninLogs | where AppDisplayName !=\"\"   | mvexpand Status |extend StatusReason = Status.FailureReason | extend SigninStatus = Status.ErrorCode |extend Country = tostring(LocationDetails.countryOrRegion) |extend State = tostring(LocationDetails.state) |extend City = tostring(LocationDetails.city) | where {selected item}   |summarize signInCount = count() by CreatedDateTime, AppDisplayName, UserDisplayName, UserPrincipalName, ClientAppUsed,tostring(SigninStatus),tostring(StatusReason), ConditionalAccessStatus, IPAddress, City, State, Country |sort by signInCount,AppDisplayName desc"
                                        }
                                    }
                                }
                            },
                            {
                                "Id": "LineChartCalloutBuilderBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "Top Sign-in Errors",
                                        "newGroup": false,
                                        "icon": "",
                                        "useIcon": false
                                    },
                                    "Header": {
                                        "Title": "Sign-in Errors over time",
                                        "Subtitle": ""
                                    },
                                    "LineChart": {
                                        "Query": "SigninLogs | extend ErrorCode = Status.errorCode | extend FailureReason = Status.failureReason | where ErrorCode !in (\"0\",\"5048\",\"50140\", \"51006\", \"50059\", \"65001\", \"52004\", \"50055\", \"50144\",\"50072\", \"50074\", \"16000\",\"16001\", \"16003\", \"50127\", \"50125\", \"50129\",\"50143\", \"81010\", \"81014\", \"81012\") | summarize count() by bin(TimeGenerated, 24h)",
                                        "Callout": {
                                            "Title": "SIGN-IN ERRORS",
                                            "Series": "",
                                            "Operation": "Average"
                                        },
                                        "yAxis": {
                                            "isLogarithmic": false,
                                            "units": {
                                                "baseUnitType": "",
                                                "baseUnit": "",
                                                "displayUnit": ""
                                            },
                                            "customLabel": ""
                                        },
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "SigninLogs | extend ErrorCode = Status.errorCode | extend FailureReason = Status.failureReason | where ErrorCode !in (\"0\",\"5048\",\"50140\", \"51006\", \"50059\", \"65001\", \"52004\", \"50055\", \"50144\",\"50072\", \"50074\", \"16000\",\"16001\", \"16003\", \"50127\", \"50125\", \"50129\",\"50143\", \"81010\", \"81014\", \"81012\") | summarize count() by AppDisplayName, tostring(ErrorCode)| sort by count_",
                                        "HideGraph": false,
                                        "enableSparklines": false,
                                        "operation": "Summary",
                                        "ColumnsTitle": {
                                            "Name": "APPNAME",
                                            "Value": "Count"
                                        },
                                        "Color": "#0072c6",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": " SigninLogs | extend ErrorCode = Status.errorCode | extend FailureReason = Status.failureReason | where ErrorCode !in (\"0\",\"5048\",\"50140\", \"51006\", \"50059\", \"65001\", \"52004\", \"50055\", \"50144\",\"50072\", \"50074\", \"16000\",\"16001\", \"16003\", \"50127\", \"50125\", \"50129\",\"50143\", \"81010\", \"81014\", \"81012\")  |extend Country = tostring(LocationDetails.countryOrRegion)  |extend State = tostring(LocationDetails.state)   |extend City = tostring(LocationDetails.city)   |where {selected item}  |summarize signInErrorCount = count() by CreatedDateTime, AppDisplayName, UserDisplayName, UserPrincipalName,tostring(FailureReason), tostring(ErrorCode), ConditionalAccessStatus, IPAddress, City, State, Country  |sort by signInErrorCount,AppDisplayName, FailureReason, ErrorCode desc",
                                        "NavigationSelect": {
                                            "NavigationQuery": " SigninLogs | extend ErrorCode = Status.errorCode | extend FailureReason = Status.failureReason | where ErrorCode !in (\"0\",\"5048\",\"50140\", \"51006\", \"50059\", \"65001\", \"52004\", \"50055\", \"50144\",\"50072\", \"50074\", \"16000\",\"16001\", \"16003\", \"50127\", \"50125\", \"50129\",\"50143\", \"81010\", \"81014\", \"81012\")  |extend Country = tostring(LocationDetails.countryOrRegion)  |extend State = tostring(LocationDetails.state)   |extend City = tostring(LocationDetails.city)   |where {selected item}  |summarize signInErrorCount = count() by CreatedDateTime, AppDisplayName, UserDisplayName, UserPrincipalName,tostring(FailureReason), tostring(ErrorCode), ConditionalAccessStatus, IPAddress, City, State, Country  |sort by signInErrorCount,AppDisplayName, FailureReason, ErrorCode desc"
                                        }
                                    }
                                }
                            },
                            {
                                "Id": "SingleQueryDonutBuilderBladeV1",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "Legacy Auth Sign-ins",
                                        "newGroup": true,
                                        "icon": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAUpSURBVGhDxZpNdhNHFIVflWzDEFYQZQWIYQw54EFCMgKvINEKjFhAhMjcklaAvQIzS3IyEJyAM7RYQcwOPLWhu3JvdUlI7qrq6rZkf+fY6m7L6r5V76/qSclV2ZvcEdnoiNaPRdQ3IqYtSuGatIs3mDMxaoqDMxx/EmVOZf/hQfG31dFMCB++tfkMD/gLHrqDK3zwehh5g18fJdcHMv7u1F1tTD0hVsBWH//2K87qP3wIispV7yqC0oSsS0AJM5JMj5sIqhay989jaenXeKuz+WvASE+G2yN3lkRcSO/4Od6BmVjnLASguQ23d91ZJX4hX03pubtyU0wlU7sppqbd6zL6Fk3ppkWQjrTMiey9Z2SMUp6RF+/h0PSJRkxhEqc2VxiFnJEzh8C35vkFuaYJ+Lzs4r6Md5CL/JSF9I6PcPWZO6vGmLf4/U5y80bGD5n44nCgjH5a6x4FU9nfvu+OS3hm5PgEvyun0gpQMpb9B0hsDaC5aN2vN2jhAODxETvCMWAuCI/5xW5jEYSzZx8q77or1VB0wF/KQpiQwrBe6toYH7HXWrDuynKYDPwghZY6ckdLBMIvk2Br4s4KaEq57vpCYf8PaRst3gCBGxwOnkh1kViEfJh1QuL1JEy/kBkvPrAwbEuewYm/TGOzADEQL8viZxjppon5t41w+587i3EGx7/rji1xITXp/wkb1uKd+mQxHDzxm88y8K2F5YA/ITZk8BOrWEy7DyWv+38Ji844DCAmQbDoPXdgWakQAjGj3MjAnS6TKiY/9w/GMh1rio6VCyG/P5GXRgKjSjE0wRj0xZRZaWXzSmEtQsirH6UbFAM/ssEhRq78s7qI0Y/c0fqEkKgYRLioGBvmK3LLQlWwViHEijHirxaqxAjX9WnY8Pvb3zKETdYt4mqBG4UTXSY7g589YlNCcXZ+lz6lEEU6uAsLxZvFJyZJSLYj4+/fasT961/G+qCZcVAXyS6qCtg5a/eRVIySETL/pfXM7eRB1nJbpnDG1VSyDaGIVz/4KoIsQYiyzz6vtZIybkPwoI9wI+/nU4TakMFgxzOYKcvuTH3LUL3SotEHwytK/COlyr4YFUGK7aihO/Ozv201rNVH6LxBEUiUUREF99xriLlPrU2IFSEyCYrYlF5UBBdaVet5s2YhURHI8pUiiL5Fn6py9o/udfVCrAgVMCeK2JLdShEW89QdhMnVvIRZqRA4dtuK8JQjmKFpsghm9KrNPG4NLewfrEyIFYHsHBSxiRIkRQR9QxQ3ziswc7Mi4fBrP3CjIy3VlgzlNOoZ95cS/YncMZ+tiNKeUy0RJGmns7yF6hfi74lEd8Ypxh2WqCGiOm8QYwYyfPDSnVnKQootGVbDvgc7Q7UJMeHZaUStNoZ/Q7vsI9rEGju4YWtiR25VUES9NkbPt79WFqJMPFoQTj9teWEXoxHWhLdOqn1ihhmF9pvLptX7MKnVx7Ad2WycbG52BrbgC4p5onrX/yvw0XMsovy7nR4hiQ5Xhk0elAzmk+Q5RG24oPAFPoegYTTN9Z4b/WBg8EO/0BARbsH5o1Zqj+R6QIDJISLeRPInRHaGaDI3T5IIEs7sbMIwXt8UbGNkCmE2oZ0H/Ka1iK9Xsnb4DYiLQcixfVQLmdE8CKRjm0kGeSJtFhZJF0KK5DXEf612fW8bq+bwKl9/qidkRiEIYrBmaNw7Z/1lDlCQHjaZgcs0E3IZ26JjuJ59MYCl/Lzg5APjR7FVwDzwrsgzn1FRp/tAHJH/AbghFlliYr94AAAAAElFTkSuQmCC",
                                        "useIcon": true
                                    },
                                    "Header": {
                                        "Title": "Legacy Auth Sign-ins by App",
                                        "Subtitle": "Top Apps using legacy auth sign-ins"
                                    },
                                    "Donut": {
                                        "Query": "SigninLogs |extend ClientAppUsed = iff(isempty(ClientAppUsed)==true,\"Unknown\" ,ClientAppUsed)  |extend isLegacyAuth = case(ClientAppUsed contains \"Browser\", \"No\", ClientAppUsed contains \"Mobile Apps and Desktop clients\", \"No\", ClientAppUsed contains \"Exchange ActiveSync\", \"No\", ClientAppUsed contains \"Other clients\", \"Yes\", \"Unknown\") |summarize count() by isLegacyAuth",
                                        "CenterLegend": {
                                            "Text": "Sign-ins",
                                            "Operation": "Percentage",
                                            "ArcsToSelect": [
                                                "Yes"
                                            ]
                                        },
                                        "Options": {
                                            "colors": [
                                                "#00188f",
                                                "#0072c6",
                                                "#00bcf2"
                                            ],
                                            "valueColorMapping": [
                                                {
                                                    "value": "Yes",
                                                    "color": "#b4009e"
                                                },
                                                {
                                                    "value": "No",
                                                    "color": "#00188f"
                                                },
                                                {
                                                    "value": "Unknown",
                                                    "color": "#fcd116"
                                                }
                                            ]
                                        },
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "SigninLogs |extend ClientAppUsed = iff(isempty(ClientAppUsed)==true,\"Unknown\" ,ClientAppUsed) |extend isLegacyAuth = case(ClientAppUsed contains \"Browser\", \"No\",  ClientAppUsed contains \"Mobile Apps and Desktop clients\", \"No\",  ClientAppUsed contains \"Exchange ActiveSync\", \"No\",  ClientAppUsed contains \"Other clients\", \"Yes\", \"Unknown\") |where isLegacyAuth==\"Yes\" |summarize count() by ClientAppUsed, AppDisplayName |sort by count_  desc",
                                        "HideGraph": false,
                                        "enableSparklines": false,
                                        "operation": "Summary",
                                        "ColumnsTitle": {
                                            "Name": "Auth Type",
                                            "Value": "Sign-ins"
                                        },
                                        "Color": "#0072c6",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": "",
                                        "NavigationSelect": {
                                            "NavigationQuery": "SigninLogs |extend ClientAppUsed = iff(isempty(ClientAppUsed)==true,\"Unknown\" ,ClientAppUsed) |extend isLegacyAuth = case(ClientAppUsed contains \"Browser\", \"No\",   ClientAppUsed contains \"Mobile Apps and Desktop clients\", \"No\",   ClientAppUsed contains \"Exchange ActiveSync\", \"No\",   ClientAppUsed contains \"Other clients\", \"Yes\", \"Unknown\") |extend errorCode = toint(Status.errorCode) |extend SigninStatus = case(errorCode == 0, \"Success\",                        errorCode == 50058, \"Interrupt\",  errorCode == 50140, \"Interrupt\",  errorCode == 51006, \"Interrupt\",  errorCode == 50059, \"Interrupt\",  errorCode == 65001, \"Interrupt\",  errorCode == 52004, \"Interrupt\",  errorCode == 50055, \"Interrupt\",  errorCode == 50144, \"Interrupt\",  errorCode == 50072, \"Interrupt\",  errorCode == 50074, \"Interrupt\",  errorCode == 16000, \"Interrupt\",  errorCode == 16001, \"Interrupt\",  errorCode == 16003, \"Interrupt\",  errorCode == 50127, \"Interrupt\",  errorCode == 50125, \"Interrupt\",  errorCode == 50129, \"Interrupt\",  errorCode == 50143, \"Interrupt\",  errorCode == 81010, \"Interrupt\",  errorCode == 81014, \"Interrupt\",  errorCode == 81012 ,\"Interrupt\",  \"Failure\") |extend StatusReason =tostring(Status.failureReason) |extend DeviceOS= DeviceDetail.operatingSystem   |extend DeviceBrowser =extract(\"([a-zA-Z]+)\",1,tostring(DeviceDetail.browser))  |extend Country = tostring(LocationDetails.countryOrRegion) |extend State = tostring(LocationDetails.state) |extend City = tostring(LocationDetails.city) |extend conditionalAccessStatusDesc = case(ConditionalAccessStatus ==0,\"Success\",                                     ConditionalAccessStatus == 1, \"Failure\",                                     ConditionalAccessStatus == 2, \"Not Applied\",                                     ConditionalAccessStatus == \"\", \"Not Applied\", \"Unknown\")|where {selected item} |project Id, CreatedDateTime, CorrelationId,ClientAppUsed,AppDisplayName, AppId, UserDisplayName, UserPrincipalName, UserId, IPAddress, Country, State, City, SigninStatus, StatusReason,DeviceOS, DeviceBrowser, conditionalAccessStatusDesc, tostring(ConditionalAccessPolicies) "
                                        }
                                    }
                                }
                            },
                            {
                                "Id": "LineChartCalloutBuilderBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "Legacy Auth Sign-ins",
                                        "newGroup": false,
                                        "icon": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAUpSURBVGhDxZpNdhNHFIVflWzDEFYQZQWIYQw54EFCMgKvINEKjFhAhMjcklaAvQIzS3IyEJyAM7RYQcwOPLWhu3JvdUlI7qrq6rZkf+fY6m7L6r5V76/qSclV2ZvcEdnoiNaPRdQ3IqYtSuGatIs3mDMxaoqDMxx/EmVOZf/hQfG31dFMCB++tfkMD/gLHrqDK3zwehh5g18fJdcHMv7u1F1tTD0hVsBWH//2K87qP3wIispV7yqC0oSsS0AJM5JMj5sIqhay989jaenXeKuz+WvASE+G2yN3lkRcSO/4Od6BmVjnLASguQ23d91ZJX4hX03pubtyU0wlU7sppqbd6zL6Fk3ppkWQjrTMiey9Z2SMUp6RF+/h0PSJRkxhEqc2VxiFnJEzh8C35vkFuaYJ+Lzs4r6Md5CL/JSF9I6PcPWZO6vGmLf4/U5y80bGD5n44nCgjH5a6x4FU9nfvu+OS3hm5PgEvyun0gpQMpb9B0hsDaC5aN2vN2jhAODxETvCMWAuCI/5xW5jEYSzZx8q77or1VB0wF/KQpiQwrBe6toYH7HXWrDuynKYDPwghZY6ckdLBMIvk2Br4s4KaEq57vpCYf8PaRst3gCBGxwOnkh1kViEfJh1QuL1JEy/kBkvPrAwbEuewYm/TGOzADEQL8viZxjppon5t41w+587i3EGx7/rji1xITXp/wkb1uKd+mQxHDzxm88y8K2F5YA/ITZk8BOrWEy7DyWv+38Ji844DCAmQbDoPXdgWakQAjGj3MjAnS6TKiY/9w/GMh1rio6VCyG/P5GXRgKjSjE0wRj0xZRZaWXzSmEtQsirH6UbFAM/ssEhRq78s7qI0Y/c0fqEkKgYRLioGBvmK3LLQlWwViHEijHirxaqxAjX9WnY8Pvb3zKETdYt4mqBG4UTXSY7g589YlNCcXZ+lz6lEEU6uAsLxZvFJyZJSLYj4+/fasT961/G+qCZcVAXyS6qCtg5a/eRVIySETL/pfXM7eRB1nJbpnDG1VSyDaGIVz/4KoIsQYiyzz6vtZIybkPwoI9wI+/nU4TakMFgxzOYKcvuTH3LUL3SotEHwytK/COlyr4YFUGK7aihO/Ozv201rNVH6LxBEUiUUREF99xriLlPrU2IFSEyCYrYlF5UBBdaVet5s2YhURHI8pUiiL5Fn6py9o/udfVCrAgVMCeK2JLdShEW89QdhMnVvIRZqRA4dtuK8JQjmKFpsghm9KrNPG4NLewfrEyIFYHsHBSxiRIkRQR9QxQ3ziswc7Mi4fBrP3CjIy3VlgzlNOoZ95cS/YncMZ+tiNKeUy0RJGmns7yF6hfi74lEd8Ypxh2WqCGiOm8QYwYyfPDSnVnKQootGVbDvgc7Q7UJMeHZaUStNoZ/Q7vsI9rEGju4YWtiR25VUES9NkbPt79WFqJMPFoQTj9teWEXoxHWhLdOqn1ihhmF9pvLptX7MKnVx7Ad2WycbG52BrbgC4p5onrX/yvw0XMsovy7nR4hiQ5Xhk0elAzmk+Q5RG24oPAFPoegYTTN9Z4b/WBg8EO/0BARbsH5o1Zqj+R6QIDJISLeRPInRHaGaDI3T5IIEs7sbMIwXt8UbGNkCmE2oZ0H/Ka1iK9Xsnb4DYiLQcixfVQLmdE8CKRjm0kGeSJtFhZJF0KK5DXEf612fW8bq+bwKl9/qidkRiEIYrBmaNw7Z/1lDlCQHjaZgcs0E3IZ26JjuJ59MYCl/Lzg5APjR7FVwDzwrsgzn1FRp/tAHJH/AbghFlliYr94AAAAAElFTkSuQmCC",
                                        "useIcon": true
                                    },
                                    "Header": {
                                        "Title": "Legacy Auth Sign-ins by Users",
                                        "Subtitle": "Top Users using legacy auth sign-ins"
                                    },
                                    "LineChart": {
                                        "Query": "SigninLogs |extend ClientAppUsed = iff(isempty(ClientAppUsed)==true,\"Unknown\" ,ClientAppUsed)  |extend isLegacyAuth = case(ClientAppUsed contains \"Browser\", \"No\", ClientAppUsed contains \"Mobile Apps and Desktop clients\", \"No\", ClientAppUsed contains \"Exchange ActiveSync\", \"No\", ClientAppUsed contains \"Other clients\", \"Yes\", \"Unknown\") |where isLegacyAuth==\"Yes\"|summarize count() by isLegacyAuth, ClientAppUsed",
                                        "Callout": {
                                            "Title": "Sign-ins",
                                            "Series": "",
                                            "Operation": "Sum"
                                        },
                                        "yAxis": {
                                            "isLogarithmic": false,
                                            "units": {
                                                "baseUnitType": "",
                                                "baseUnit": "",
                                                "displayUnit": ""
                                            },
                                            "customLabel": ""
                                        },
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "SigninLogs |extend ClientAppUsed = iff(isempty(ClientAppUsed)==true,\"Unknown\" ,ClientAppUsed)  |extend isLegacyAuth = case(ClientAppUsed contains \"Browser\", \"No\", ClientAppUsed contains \"Mobile Apps and Desktop clients\", \"No\", ClientAppUsed contains \"Exchange ActiveSync\", \"No\", ClientAppUsed contains \"Other clients\", \"Yes\", \"Unknown\") |where isLegacyAuth==\"Yes\"|summarize count() by isLegacyAuth, UserDisplayName",
                                        "HideGraph": false,
                                        "enableSparklines": false,
                                        "operation": "Summary",
                                        "ColumnsTitle": {
                                            "Name": "Type",
                                            "Value": "Count"
                                        },
                                        "Color": "#0072c6",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": "SigninLogs |extend ClientAppUsed = iff(isempty(ClientAppUsed)==true,\"Unknown\" ,ClientAppUsed) |extend isLegacyAuth = case(ClientAppUsed contains \"Browser\", \"No\",   ClientAppUsed contains \"Mobile Apps and Desktop clients\", \"No\",   ClientAppUsed contains \"Exchange ActiveSync\", \"No\",   ClientAppUsed contains \"Other clients\", \"Yes\", \"Unknown\") |extend errorCode = toint(Status.errorCode) |extend SigninStatus = case(errorCode == 0, \"Success\",                        errorCode == 50058, \"Interrupt\",  errorCode == 50140, \"Interrupt\",  errorCode == 51006, \"Interrupt\",  errorCode == 50059, \"Interrupt\",  errorCode == 65001, \"Interrupt\",  errorCode == 52004, \"Interrupt\",  errorCode == 50055, \"Interrupt\",  errorCode == 50144, \"Interrupt\",  errorCode == 50072, \"Interrupt\",  errorCode == 50074, \"Interrupt\",  errorCode == 16000, \"Interrupt\",  errorCode == 16001, \"Interrupt\",  errorCode == 16003, \"Interrupt\",  errorCode == 50127, \"Interrupt\",  errorCode == 50125, \"Interrupt\",  errorCode == 50129, \"Interrupt\",  errorCode == 50143, \"Interrupt\",  errorCode == 81010, \"Interrupt\",  errorCode == 81014, \"Interrupt\",  errorCode == 81012 ,\"Interrupt\",  \"Failure\") |extend StatusReason =tostring(Status.failureReason) |extend DeviceOS= DeviceDetail.operatingSystem   |extend DeviceBrowser =extract(\"([a-zA-Z]+)\",1,tostring(DeviceDetail.browser))  |extend Country = tostring(LocationDetails.countryOrRegion) |extend State = tostring(LocationDetails.state) |extend City = tostring(LocationDetails.city) |extend conditionalAccessStatusDesc = case(ConditionalAccessStatus ==0,\"Success\",                                     ConditionalAccessStatus == 1, \"Failure\",                                     ConditionalAccessStatus == 2, \"Not Applied\",                                     ConditionalAccessStatus == \"\", \"Not Applied\", \"Unknown\")|where {selected item} |project Id, CreatedDateTime, CorrelationId,ClientAppUsed,AppDisplayName, AppId, UserDisplayName, UserPrincipalName, UserId, IPAddress, Country, State, City, SigninStatus, StatusReason,DeviceOS, DeviceBrowser, conditionalAccessStatusDesc, tostring(ConditionalAccessPolicies) ",
                                        "NavigationSelect": {
                                            "NavigationQuery": "SigninLogs |extend ClientAppUsed = iff(isempty(ClientAppUsed)==true,\"Unknown\" ,ClientAppUsed) |extend isLegacyAuth = case(ClientAppUsed contains \"Browser\", \"No\",   ClientAppUsed contains \"Mobile Apps and Desktop clients\", \"No\",   ClientAppUsed contains \"Exchange ActiveSync\", \"No\",   ClientAppUsed contains \"Other clients\", \"Yes\", \"Unknown\") |extend errorCode = toint(Status.errorCode) |extend SigninStatus = case(errorCode == 0, \"Success\",                        errorCode == 50058, \"Interrupt\",  errorCode == 50140, \"Interrupt\",  errorCode == 51006, \"Interrupt\",  errorCode == 50059, \"Interrupt\",  errorCode == 65001, \"Interrupt\",  errorCode == 52004, \"Interrupt\",  errorCode == 50055, \"Interrupt\",  errorCode == 50144, \"Interrupt\",  errorCode == 50072, \"Interrupt\",  errorCode == 50074, \"Interrupt\",  errorCode == 16000, \"Interrupt\",  errorCode == 16001, \"Interrupt\",  errorCode == 16003, \"Interrupt\",  errorCode == 50127, \"Interrupt\",  errorCode == 50125, \"Interrupt\",  errorCode == 50129, \"Interrupt\",  errorCode == 50143, \"Interrupt\",  errorCode == 81010, \"Interrupt\",  errorCode == 81014, \"Interrupt\",  errorCode == 81012 ,\"Interrupt\",  \"Failure\") |extend StatusReason =tostring(Status.failureReason) |extend DeviceOS= DeviceDetail.operatingSystem   |extend DeviceBrowser =extract(\"([a-zA-Z]+)\",1,tostring(DeviceDetail.browser))  |extend Country = tostring(LocationDetails.countryOrRegion) |extend State = tostring(LocationDetails.state) |extend City = tostring(LocationDetails.city) |extend conditionalAccessStatusDesc = case(ConditionalAccessStatus ==0,\"Success\",                                     ConditionalAccessStatus == 1, \"Failure\",                                     ConditionalAccessStatus == 2, \"Not Applied\",                                     ConditionalAccessStatus == \"\", \"Not Applied\", \"Unknown\")|where {selected item} |project Id, CreatedDateTime, CorrelationId,ClientAppUsed,AppDisplayName, AppId, UserDisplayName, UserPrincipalName, UserId, IPAddress, Country, State, City, SigninStatus, StatusReason,DeviceOS, DeviceBrowser, conditionalAccessStatusDesc, tostring(ConditionalAccessPolicies) "
                                        }
                                    }
                                }
                            },
                            {
                                "Id": "LineChartCalloutBuilderBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "Sign-ins triggering CA Policies",
                                        "newGroup": true,
                                        "icon": "",
                                        "useIcon": false
                                    },
                                    "Header": {
                                        "Title": "Blocked Sign-ins due to CA Policies",
                                        "Subtitle": ""
                                    },
                                    "LineChart": {
                                        "Query": "SigninLogs |where ConditionalAccessStatus == 1 |summarize count() by bin(TimeGenerated, 24h)",
                                        "Callout": {
                                            "Title": "Signins",
                                            "Series": "",
                                            "Operation": "Sum"
                                        },
                                        "yAxis": {
                                            "isLogarithmic": false,
                                            "units": {
                                                "baseUnitType": "",
                                                "baseUnit": "",
                                                "displayUnit": ""
                                            },
                                            "customLabel": ""
                                        },
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "SigninLogs |where ConditionalAccessStatus == 1 |summarize SignIns = dcount(Id) by UserDisplayName, AppDisplayName | sort by SignIns, UserDisplayName, AppDisplayName desc",
                                        "HideGraph": false,
                                        "enableSparklines": false,
                                        "operation": "Summary",
                                        "ColumnsTitle": {
                                            "Name": "Type",
                                            "Value": "Count"
                                        },
                                        "Color": "#0072c6",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": "SigninLogs |where ConditionalAccessStatus == 1 |extend ClientAppUsed = iff(isempty(ClientAppUsed)==true,\"Unknown\" ,ClientAppUsed) |extend isLegacyAuth = case(ClientAppUsed contains \"Browser\", \"No\",                                                            ClientAppUsed contains \"Mobile Apps and Desktop clients\", \"No\",                             ClientAppUsed contains \"Exchange ActiveSync\", \"No\",                             ClientAppUsed contains \"Other clients\", \"Yes\", \"Unknown\") |extend errorCode = toint(Status.errorCode) |extend SigninStatus = case(errorCode == 0, \"Success\",                            errorCode == 50058, \"Interrupt\",                           errorCode == 50140, \"Interrupt\",                                                        errorCode == 51006, \"Interrupt\",                                                        errorCode == 50059, \"Interrupt\",                                                        errorCode == 65001, \"Interrupt\",                                                        errorCode == 52004, \"Interrupt\",                                                        errorCode == 50055, \"Interrupt\",                                                        errorCode == 50144, \"Interrupt\",                                                        errorCode == 50072, \"Interrupt\",                                                        errorCode == 50074, \"Interrupt\",                                                        errorCode == 16000, \"Interrupt\",                                                        errorCode == 16001, \"Interrupt\",                                                        errorCode == 16003, \"Interrupt\",                                                        errorCode == 50127, \"Interrupt\",                                                        errorCode == 50125, \"Interrupt\",                                                        errorCode == 50129, \"Interrupt\",                                                        errorCode == 50143, \"Interrupt\",                                                        errorCode == 81010, \"Interrupt\",                                                        errorCode == 81014, \"Interrupt\",                             errorCode == 81012 ,\"Interrupt\",  \"Failure\") |extend StatusReason =tostring(iff(errorCode == 50158, \"External security challenge was not satisfied\", Status.failureReason)) |extend Country = tostring(LocationDetails.countryOrRegion) |extend State = tostring(LocationDetails.state) |extend City = tostring(LocationDetails.city) |extend DeviceOS= DeviceDetail.operatingSystem |extend DeviceBrowser =extract(\"([a-zA-Z]+)\",1,tostring(DeviceDetail.browser)) |extend conditionalAccessStatusDesc = case(ConditionalAccessStatus ==0,\"Success\",                                     ConditionalAccessStatus == 1, \"Failure\",                                     ConditionalAccessStatus == 2, \"Not Applied\",                                     ConditionalAccessStatus == \"\", \"Not Applied\", \"Unknown\") |mvexpand ConditionalAccessPolicies |extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0]) |extend CAPolicyName = tostring(ConditionalAccessPolicies.displayName ) |extend CAPolicyResult = toint(ConditionalAccessPolicies.result) |extend CAPolicyResultDesc = case(CAPolicyResult == 0, \"Success\",                                   CAPolicyResult ==1, \"Failure\",                                   CAPolicyResult ==2, \"Not Applied\",                                   CAPolicyResult ==3, \"Not Enabled\",                                   CAPolicyResult ==4, \"Unknown\",                                   CAPolicyResult ==5, \"Unknown\", \"Not Applied\") |where ConditionalAccessStatus == 1 |where {selected item} |project Id, CreatedDateTime, CorrelationId,ClientAppUsed,AppDisplayName, AppId, UserDisplayName, UserPrincipalName, UserId, IPAddress, Country, State, City, SigninStatus, errorCode, StatusReason,DeviceOS, DeviceBrowser, conditionalAccessStatusDesc, CAGrantControlName, CAPolicyName, CAPolicyResultDesc",
                                        "NavigationSelect": {
                                            "NavigationQuery": "SigninLogs |where ConditionalAccessStatus == 1 |extend ClientAppUsed = iff(isempty(ClientAppUsed)==true,\"Unknown\" ,ClientAppUsed) |extend isLegacyAuth = case(ClientAppUsed contains \"Browser\", \"No\",                                                            ClientAppUsed contains \"Mobile Apps and Desktop clients\", \"No\",                             ClientAppUsed contains \"Exchange ActiveSync\", \"No\",                             ClientAppUsed contains \"Other clients\", \"Yes\", \"Unknown\") |extend errorCode = toint(Status.errorCode) |extend SigninStatus = case(errorCode == 0, \"Success\",                            errorCode == 50058, \"Interrupt\",                           errorCode == 50140, \"Interrupt\",                                                        errorCode == 51006, \"Interrupt\",                                                        errorCode == 50059, \"Interrupt\",                                                        errorCode == 65001, \"Interrupt\",                                                        errorCode == 52004, \"Interrupt\",                                                        errorCode == 50055, \"Interrupt\",                                                        errorCode == 50144, \"Interrupt\",                                                        errorCode == 50072, \"Interrupt\",                                                        errorCode == 50074, \"Interrupt\",                                                        errorCode == 16000, \"Interrupt\",                                                        errorCode == 16001, \"Interrupt\",                                                        errorCode == 16003, \"Interrupt\",                                                        errorCode == 50127, \"Interrupt\",                                                        errorCode == 50125, \"Interrupt\",                                                        errorCode == 50129, \"Interrupt\",                                                        errorCode == 50143, \"Interrupt\",                                                        errorCode == 81010, \"Interrupt\",                                                        errorCode == 81014, \"Interrupt\",                             errorCode == 81012 ,\"Interrupt\",  \"Failure\") |extend StatusReason =tostring(iff(errorCode == 50158, \"External security challenge was not satisfied\", Status.failureReason)) |extend Country = tostring(LocationDetails.countryOrRegion) |extend State = tostring(LocationDetails.state) |extend City = tostring(LocationDetails.city) |extend DeviceOS= DeviceDetail.operatingSystem |extend DeviceBrowser =extract(\"([a-zA-Z]+)\",1,tostring(DeviceDetail.browser)) |extend conditionalAccessStatusDesc = case(ConditionalAccessStatus ==0,\"Success\",                                     ConditionalAccessStatus == 1, \"Failure\",                                     ConditionalAccessStatus == 2, \"Not Applied\",                                     ConditionalAccessStatus == \"\", \"Not Applied\", \"Unknown\") |mvexpand ConditionalAccessPolicies |extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0]) |extend CAPolicyName = tostring(ConditionalAccessPolicies.displayName ) |extend CAPolicyResult = toint(ConditionalAccessPolicies.result) |extend CAPolicyResultDesc = case(CAPolicyResult == 0, \"Success\",                                   CAPolicyResult ==1, \"Failure\",                                   CAPolicyResult ==2, \"Not Applied\",                                   CAPolicyResult ==3, \"Not Enabled\",                                   CAPolicyResult ==4, \"Unknown\",                                   CAPolicyResult ==5, \"Unknown\", \"Not Applied\") |where ConditionalAccessStatus == 1 |where {selected item} |project Id, CreatedDateTime, CorrelationId,ClientAppUsed,AppDisplayName, AppId, UserDisplayName, UserPrincipalName, UserId, IPAddress, Country, State, City, SigninStatus, errorCode, StatusReason,DeviceOS, DeviceBrowser, conditionalAccessStatusDesc, CAGrantControlName, CAPolicyName, CAPolicyResultDesc"
                                        }
                                    }
                                }
                            },
                            {
                                "Id": "LineChartCalloutBuilderBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "Sign-Ins triggering CA Policies",
                                        "newGroup": false,
                                        "icon": "",
                                        "useIcon": false
                                    },
                                    "Header": {
                                        "Title": "Successful MFA Sign-ins ",
                                        "Subtitle": "MFA based Sign-ins triggered by CA Policy"
                                    },
                                    "LineChart": {
                                        "Query": "SigninLogs |extend errorCode = toint(Status.errorCode) |extend conditionalAccessStatusDesc = case(ConditionalAccessStatus ==0,\"Success\",                                     ConditionalAccessStatus == 1, \"Failure\",                                     ConditionalAccessStatus == 2, \"Not Applied\",                                     ConditionalAccessStatus == \"\", \"Not Applied\", \"Unknown\") |mvexpand ConditionalAccessPolicies |extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0]) |extend CAPolicyName = tostring(ConditionalAccessPolicies.displayName ) |extend CAPolicyResult = toint(ConditionalAccessPolicies.result) |extend CAPolicyResultDesc = case(CAPolicyResult == 0, \"Success\",                                   CAPolicyResult ==1, \"Failure\",                                   CAPolicyResult ==2, \"Not Applied\",                                   CAPolicyResult ==3, \"Not Enabled\",                                   CAPolicyResult ==4, \"Unknown\",                                   CAPolicyResult ==5, \"Unknown\", \"Not Applied\") |where ConditionalAccessStatus == 0 and CAGrantControlName contains \"MFA\" and CAPolicyResult == 0 and errorCode == 0 |summarize count() by bin(TimeGenerated, 24h)",
                                        "Callout": {
                                            "Title": "Sign-ins",
                                            "Series": "",
                                            "Operation": "Sum"
                                        },
                                        "yAxis": {
                                            "isLogarithmic": false,
                                            "units": {
                                                "baseUnitType": "",
                                                "baseUnit": "",
                                                "displayUnit": ""
                                            },
                                            "customLabel": ""
                                        },
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "SigninLogs |extend errorCode = toint(Status.errorCode) |extend conditionalAccessStatusDesc = case(ConditionalAccessStatus ==0,\"Success\",                                     ConditionalAccessStatus == 1, \"Failure\",                                     ConditionalAccessStatus == 2, \"Not Applied\",                                     ConditionalAccessStatus == \"\", \"Not Applied\", \"Unknown\") |mvexpand ConditionalAccessPolicies |extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0]) |extend CAPolicyName = tostring(ConditionalAccessPolicies.displayName ) |extend CAPolicyResult = toint(ConditionalAccessPolicies.result) |extend CAPolicyResultDesc = case(CAPolicyResult == 0, \"Success\",                                   CAPolicyResult ==1, \"Failure\",                                   CAPolicyResult ==2, \"Not Applied\",                                   CAPolicyResult ==3, \"Not Enabled\",                                   CAPolicyResult ==4, \"Unknown\",                                   CAPolicyResult ==5, \"Unknown\", \"Not Applied\") |where ConditionalAccessStatus == 0 and CAGrantControlName contains \"MFA\" and CAPolicyResult == 0 and errorCode == 0 |summarize SignIns = dcount(Id) by  AppDisplayName, UserDisplayName | sort by SignIns, AppDisplayName, UserDisplayName desc",
                                        "HideGraph": false,
                                        "enableSparklines": true,
                                        "operation": "Summary",
                                        "ColumnsTitle": {
                                            "Name": "AppName",
                                            "Value": "Count"
                                        },
                                        "Color": "#0072c6",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": " SigninLogs |extend ClientAppUsed = iff(isempty(ClientAppUsed)==true,\"Unknown\" ,ClientAppUsed) |extend isLegacyAuth = case(ClientAppUsed contains \"Browser\", \"No\",                                                            ClientAppUsed contains \"Mobile Apps and Desktop clients\", \"No\",                             ClientAppUsed contains \"Exchange ActiveSync\", \"No\",                             ClientAppUsed contains \"Other clients\", \"Yes\", \"Unknown\") |extend errorCode = toint(Status.errorCode) |extend SigninStatus = case(errorCode == 0, \"Success\",                            errorCode == 50058, \"Interrupt\",                           errorCode == 50140, \"Interrupt\",                                                        errorCode == 51006, \"Interrupt\",                                                        errorCode == 50059, \"Interrupt\",                                                        errorCode == 65001, \"Interrupt\",                                                        errorCode == 52004, \"Interrupt\",                                                        errorCode == 50055, \"Interrupt\",                                                        errorCode == 50144, \"Interrupt\",                                                        errorCode == 50072, \"Interrupt\",                                                        errorCode == 50074, \"Interrupt\",                                                        errorCode == 16000, \"Interrupt\",                                                        errorCode == 16001, \"Interrupt\",                                                        errorCode == 16003, \"Interrupt\",                                                        errorCode == 50127, \"Interrupt\",                                                        errorCode == 50125, \"Interrupt\",                                                        errorCode == 50129, \"Interrupt\",                                                        errorCode == 50143, \"Interrupt\",                                                        errorCode == 81010, \"Interrupt\",                                                        errorCode == 81014, \"Interrupt\",                             errorCode == 81012 ,\"Interrupt\",  \"Failure\") |extend StatusReason =tostring(iff(errorCode == 50158, \"External security challenge was not satisfied\", Status.failureReason)) |extend Country = tostring(LocationDetails.countryOrRegion) |extend State = tostring(LocationDetails.state) |extend City = tostring(LocationDetails.city) |extend DeviceOS= DeviceDetail.operatingSystem   |extend DeviceBrowser =extract(\"([a-zA-Z]+)\",1,tostring(DeviceDetail.browser))  |extend conditionalAccessStatusDesc = case(ConditionalAccessStatus ==0,\"Success\",                                     ConditionalAccessStatus == 1, \"Failure\",                                     ConditionalAccessStatus == 2, \"Not Applied\",                                     ConditionalAccessStatus == \"\", \"Not Applied\", \"Unknown\") |mvexpand ConditionalAccessPolicies |extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0]) |extend CAPolicyName = tostring(ConditionalAccessPolicies.displayName ) |extend CAPolicyResult = toint(ConditionalAccessPolicies.result) |extend CAPolicyResultDesc = case(CAPolicyResult == 0, \"Success\",                                   CAPolicyResult ==1, \"Failure\",                                   CAPolicyResult ==2, \"Not Applied\",                                   CAPolicyResult ==3, \"Not Enabled\",                                   CAPolicyResult ==4, \"Unknown\",                                   CAPolicyResult ==5, \"Unknown\", \"Not Applied\") |where ConditionalAccessStatus == 0 and CAGrantControlName contains \"MFA\" and CAPolicyResult == 0 and errorCode == 0 |where {selected item} |project Id, CreatedDateTime, CorrelationId,ClientAppUsed,AppDisplayName, AppId, UserDisplayName, UserPrincipalName, UserId, IPAddress, Country, State, City, SigninStatus, StatusReason,DeviceOS, DeviceBrowser, conditionalAccessStatusDesc, CAGrantControlName, CAPolicyName, CAPolicyResultDesc",
                                        "NavigationSelect": {
                                            "NavigationQuery": " SigninLogs |extend ClientAppUsed = iff(isempty(ClientAppUsed)==true,\"Unknown\" ,ClientAppUsed) |extend isLegacyAuth = case(ClientAppUsed contains \"Browser\", \"No\",                                                            ClientAppUsed contains \"Mobile Apps and Desktop clients\", \"No\",                             ClientAppUsed contains \"Exchange ActiveSync\", \"No\",                             ClientAppUsed contains \"Other clients\", \"Yes\", \"Unknown\") |extend errorCode = toint(Status.errorCode) |extend SigninStatus = case(errorCode == 0, \"Success\",                            errorCode == 50058, \"Interrupt\",                           errorCode == 50140, \"Interrupt\",                                                        errorCode == 51006, \"Interrupt\",                                                        errorCode == 50059, \"Interrupt\",                                                        errorCode == 65001, \"Interrupt\",                                                        errorCode == 52004, \"Interrupt\",                                                        errorCode == 50055, \"Interrupt\",                                                        errorCode == 50144, \"Interrupt\",                                                        errorCode == 50072, \"Interrupt\",                                                        errorCode == 50074, \"Interrupt\",                                                        errorCode == 16000, \"Interrupt\",                                                        errorCode == 16001, \"Interrupt\",                                                        errorCode == 16003, \"Interrupt\",                                                        errorCode == 50127, \"Interrupt\",                                                        errorCode == 50125, \"Interrupt\",                                                        errorCode == 50129, \"Interrupt\",                                                        errorCode == 50143, \"Interrupt\",                                                        errorCode == 81010, \"Interrupt\",                                                        errorCode == 81014, \"Interrupt\",                             errorCode == 81012 ,\"Interrupt\",  \"Failure\") |extend StatusReason =tostring(iff(errorCode == 50158, \"External security challenge was not satisfied\", Status.failureReason)) |extend Country = tostring(LocationDetails.countryOrRegion) |extend State = tostring(LocationDetails.state) |extend City = tostring(LocationDetails.city) |extend DeviceOS= DeviceDetail.operatingSystem   |extend DeviceBrowser =extract(\"([a-zA-Z]+)\",1,tostring(DeviceDetail.browser))  |extend conditionalAccessStatusDesc = case(ConditionalAccessStatus ==0,\"Success\",                                     ConditionalAccessStatus == 1, \"Failure\",                                     ConditionalAccessStatus == 2, \"Not Applied\",                                     ConditionalAccessStatus == \"\", \"Not Applied\", \"Unknown\") |mvexpand ConditionalAccessPolicies |extend CAGrantControlName = tostring(ConditionalAccessPolicies.enforcedGrantControls[0]) |extend CAPolicyName = tostring(ConditionalAccessPolicies.displayName ) |extend CAPolicyResult = toint(ConditionalAccessPolicies.result) |extend CAPolicyResultDesc = case(CAPolicyResult == 0, \"Success\",                                   CAPolicyResult ==1, \"Failure\",                                   CAPolicyResult ==2, \"Not Applied\",                                   CAPolicyResult ==3, \"Not Enabled\",                                   CAPolicyResult ==4, \"Unknown\",                                   CAPolicyResult ==5, \"Unknown\", \"Not Applied\") |where ConditionalAccessStatus == 0 and CAGrantControlName contains \"MFA\" and CAPolicyResult == 0 and errorCode == 0 |where {selected item} |project Id, CreatedDateTime, CorrelationId,ClientAppUsed,AppDisplayName, AppId, UserDisplayName, UserPrincipalName, UserId, IPAddress, Country, State, City, SigninStatus, StatusReason,DeviceOS, DeviceBrowser, conditionalAccessStatusDesc, CAGrantControlName, CAPolicyName, CAPolicyResultDesc"
                                        }
                                    }
                                }
                            },
                            {
                                "Id": "LineChartBuilderBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "Sign-in triggering CA Policies",
                                        "newGroup": false,
                                        "icon": "",
                                        "useIcon": false
                                    },
                                    "Header": {
                                        "Title": "Failed MFA Sign-ins",
                                        "Subtitle": "MFA based sign-ins triggered by CA Policy"
                                    },
                                    "LineChart": {
                                        "Query": " SigninLogs | extend ErrorCode = Status.errorCode  | where ConditionalAccessStatus == 1| where ErrorCode == 50075 or ErrorCode == 50074 or ErrorCode == 50079 |summarize count() by bin(TimeGenerated, 24h)",
                                        "yAxis": {
                                            "isLogarithmic": false,
                                            "units": {
                                                "baseUnitType": "",
                                                "baseUnit": "",
                                                "displayUnit": ""
                                            },
                                            "customLabel": ""
                                        },
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "SigninLogs  | extend ErrorCode = Status.errorCode  | where ErrorCode == 50075 or ErrorCode == 50074 or ErrorCode == 50079 |where ConditionalAccessStatus == 1 |summarize count() by ClientAppUsed, UserDisplayName| sort by count_",
                                        "HideGraph": false,
                                        "enableSparklines": false,
                                        "operation": "Summary",
                                        "ColumnsTitle": {
                                            "Name": "AppName",
                                            "Value": "Count"
                                        },
                                        "Color": "#0072c6",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": " SigninLogs   | extend ErrorCode = Status.errorCode   | extend FailureReason = Status.FailureReason |where ConditionalAccessStatus == 1| where ErrorCode == 50075 or ErrorCode == 50074 or ErrorCode == 50079    |extend Country = tostring(LocationDetails.countryOrRegion)  |extend State = tostring(LocationDetails.state)    |extend City = tostring(LocationDetails.city) |where {selected item}    |summarize signInErrorCount = count() by CreatedDateTime, AppDisplayName, UserDisplayName, UserPrincipalName, ClientAppUsed,tostring(FailureReason), tostring(ErrorCode),ConditionalAccessStatus, IPAddress, City, State, Country  |sort by signInErrorCount,AppDisplayName, FailureReason, ErrorCode desc",
                                        "NavigationSelect": {
                                            "NavigationQuery": " SigninLogs   | extend ErrorCode = Status.errorCode   | extend FailureReason = Status.FailureReason |where ConditionalAccessStatus == 1| where ErrorCode == 50075 or ErrorCode == 50074 or ErrorCode == 50079    |extend Country = tostring(LocationDetails.countryOrRegion)  |extend State = tostring(LocationDetails.state)    |extend City = tostring(LocationDetails.city) |where {selected item}    |summarize signInErrorCount = count() by CreatedDateTime, AppDisplayName, UserDisplayName, UserPrincipalName, ClientAppUsed,tostring(FailureReason), tostring(ErrorCode),ConditionalAccessStatus, IPAddress, City, State, Country  |sort by signInErrorCount,AppDisplayName, FailureReason, ErrorCode desc"
                                        }
                                    }
                                }
                            },
                            {
                                "Id": "NumberTileListBuilderBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "Apps and CA Policies",
                                        "newGroup": true,
                                        "icon": "",
                                        "useIcon": false
                                    },
                                    "Tile": {
                                        "Query": "SigninLogs | where ConditionalAccessStatus == \"2\" or ConditionalAccessStatus == \"3\" | join kind = leftanti( SigninLogs | where ConditionalAccessStatus == 0 or ConditionalAccessStatus == 1) on AppId |summarize AppCount = dcount(AppId)",
                                        "Legend": "Apps without CA Policies",
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "SigninLogs | where ConditionalAccessStatus == \"2\" or ConditionalAccessStatus == \"3\" | join kind = leftanti( SigninLogs | where ConditionalAccessStatus == 0 or ConditionalAccessStatus == 1) on AppId |summarize count() by AppDisplayName |sort by count_ desc",
                                        "HideGraph": false,
                                        "enableSparklines": false,
                                        "operation": "Summary",
                                        "ColumnsTitle": {
                                            "Name": "App Name",
                                            "Value": "# Sign-ins (no CA policy applied)"
                                        },
                                        "Color": "#0072c6",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": "SigninLogs | where ConditionalAccessStatus == \"2\" or ConditionalAccessStatus == \"3\" | join kind = leftanti( SigninLogs | where ConditionalAccessStatus == 0 or ConditionalAccessStatus == 1) on AppId|where{selected item}",
                                        "NavigationSelect": {
                                            "NavigationQuery": "SigninLogs | where ConditionalAccessStatus == \"2\" or ConditionalAccessStatus == \"3\" | join kind = leftanti( SigninLogs | where ConditionalAccessStatus == 0 or ConditionalAccessStatus == 1) on AppId|where{selected item}"
                                        }
                                    }
                                }
                            }
                        ],
                        "Filters": [],
                        "OverviewTile": {
                            "Id": "SingleQueryDonutBuilderTileV1",
                            "Type": "OverviewTile",
                            "Version": 2,
                            "Configuration": {
                                "Donut": {
                                    "Query": "SigninLogs |mvexpand Status |extend errorCode = Status.errorCode |extend SigninStatus = case(errorCode == 0, \"Success\",                       errorCode == 50058, \"Interrupt\",                       errorCode == 50140, \"Interrupt\",                       errorCode == 51006, \"Interrupt\",                       errorCode == 50059, \"Interrupt\",                       errorCode == 65001, \"Interrupt\",                       errorCode == 52004, \"Interrupt\",                       errorCode == 50055, \"Interrupt\",                       errorCode == 50144, \"Interrupt\",                       errorCode == 50072, \"Interrupt\",                       errorCode == 50074, \"Interrupt\",                       errorCode == 16000, \"Interrupt\",                       errorCode == 16001, \"Interrupt\",                       errorCode == 16003, \"Interrupt\",                       errorCode == 50127, \"Interrupt\",                       errorCode == 50125, \"Interrupt\",                       errorCode == 50129, \"Interrupt\",                       errorCode == 50143, \"Interrupt\",                       errorCode == 81010, \"Interrupt\",                       errorCode == 81014, \"Interrupt\",                       errorCode == 81012 ,\"Interrupt\",                       \"Failure\") |summarize signInCount = count() by SigninStatus |sort by signInCount desc",
                                    "CenterLegend": {
                                        "Text": "Sign-ins",
                                        "Operation": "Percentage",
                                        "ArcsToSelect": [
                                            "Success",
                                            "Interrupt"
                                        ]
                                    },
                                    "Options": {
                                        "colors": [
                                            "#00188f",
                                            "#0072c6",
                                            "#00bcf2"
                                        ],
                                        "valueColorMapping": [
                                            {
                                                "value": "Success",
                                                "color": "#0072c6"
                                            },
                                            {
                                                "value": "Failure",
                                                "color": "#ba141a"
                                            },
                                            {
                                                "value": "Interrupt",
                                                "color": "#fcd116"
                                            }
                                        ]
                                    }
                                },
                                "Advanced": {
                                    "DataFlowVerification": {
                                        "Enabled": false,
                                        "Query": "search * | limit 1 | project TimeGenerated",
                                        "Message": ""
                                    }
                                }
                            }
                        }
                    }
                }
            ]
        }
    ]
}